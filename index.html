<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Amazon Super Search</title>
  <!-- SEO Meta Tags -->
  <meta name="description" content="Amazon Super Search: Advanced Amazon product search with filters including price range, discounts, Prime only, stock availability, reviews, and more. Embed affiliate tag for easy monetization.">
  <meta name="keywords" content="Amazon search, affiliate Amazon, product filters, price range, discounts, Prime, in-stock, customer reviews">
  <meta name="robots" content="index, follow">
  <link rel="canonical" href="https://amazonsupersearch.blogspot.com/">
  <!-- Open Graph / Social -->
  <meta property="og:title" content="Amazon Super Search">
  <meta property="og:description" content="Advanced Amazon search interface with powerful filters and affiliate integration.">
  <meta property="og:url" content="https://amazonsupersearch.blogspot.com/">
  <meta property="og:type" content="website">
  <meta property="og:image" content="https://amazonsupersearch.blogspot.com/thumbnail.png">
  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Amazon Super Search">
  <meta name="twitter:description" content="Advanced Amazon search interface with powerful filters and affiliate integration.">
  <meta name="twitter:image" content="https://amazonsupersearch.blogspot.com/thumbnail.png">
  <!-- Bootstrap CSS -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.1.3/css/bootstrap.min.css" rel="stylesheet" />
  <!-- Tagify CSS & JS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@yaireo/tagify/dist/tagify.css" />
  <script src="https://cdn.jsdelivr.net/npm/@yaireo/tagify/dist/tagify.min.js"></script>
  <style>
    /* ——— Fancy frames & existing styles ——— */
  </style>
</head>
<body>
  <div class="container-fluid bg-white p-3 p-md-4 rounded shadow-sm">
    <!-- form HTML unchanged -->
    <form id="amazon-search-form" autocomplete="off">
      <!-- hidden tag and all filter markup as provided above -->
    </form>
  </div>

  <!-- Bootstrap JS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.1.3/js/bootstrap.bundle.min.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // initialize Tagify
      new Tagify(document.getElementById('brandInclude'), { dropdown: { maxItems: 20 }});
      new Tagify(document.getElementById('brandExclude'), { dropdown: { maxItems: 20 }});

      document.getElementById('amazon-search-form').addEventListener('submit', function(e) {
        e.preventDefault();
        const data = new FormData(this);
        const params = new URLSearchParams();
        const rhParts = [];

        // Keywords & Boolean
        let q = (data.get('q')||'').trim();
        if (data.get('enable-boolean')) {
          q = q.replace(/\bAND\b/gi,' ').replace(/\bNOT\b/gi,'-');
          params.set('bop','enable');
        }
        if (q) params.set('k', q);

        // Include Brands
        try {
          JSON.parse(data.get('brand-include')||'[]').forEach(o => rhParts.push(`p_89:${encodeURIComponent(o.value)}`));
        } catch {}
        // Exclude Brands
        try {
          JSON.parse(data.get('brand-exclude')||'[]').forEach(o => rhParts.push(`p_89:-${encodeURIComponent(o.value)}`));
        } catch {}

        // Price Range
        const min = parseFloat(data.get('min-price'));
        const max = parseFloat(data.get('max-price'));
        if (!isNaN(min)||!isNaN(max)) {
          const low = !isNaN(min)?Math.round(min*100):0;
          const high = !isNaN(max)?Math.round(max*100):'';
          rhParts.push(`p_36:${low}-${high}`);
        }

        // Discount
        if (data.get('percent-off')) rhParts.push(`p_pct-off:${data.get('percent-off')}-`);

        // Checkboxes mapping
        const mapFlag = {
          'prime-only':'p_n_feature_three_browse-bin:1249187011',
          'in-stock':'p_n_availability:1248879011',
          'free-shipping':'p_76:13184787011',
          'fba-only':'p_n_shipping_option-bin:3262373011',
          'lightning-deals':'p_n_specials_match:154606011',
          'coupons':'p_n_feature_ten_browse-bin:196807011',
          'subscribe-save':'p_n_feature_fifteen_browse-bin:15530160011',
          'amazon-choice':'p_6:ATVPDKIKX0DER',
          'best-seller':'p_n_feature_fourteen_browse-bin:11626143011',
          'free-returns':'p_n_feature_fourteen_browse-bin:11626143011',
          'gift-wrap':'p_n_feature_seventeen_browse-bin:158073011'
        };
        Object.keys(mapFlag).forEach(flag => {
          if (data.get(flag)==='on') rhParts.push(mapFlag[flag]);
        });

        // Advanced panels flags (example for enable-boolean handled earlier)
        // You can add mapping here for other advanced checkboxes and fields.

        if (rhParts.length) params.set('rh', rhParts.join(','));

        // Affiliate tag
        params.set('tag', data.get('tag'));

        // Redirect
        const url = `https://www.amazon.com/s?${params.toString()}`;
        window.open(url, '_blank');
      });
    });
  </script>
</body>
</html>
